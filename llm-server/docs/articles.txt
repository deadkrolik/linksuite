h2. Общее описание

Размещение статей это еще один способ продвижения ваших проектов за счет уже существующих мощностей сайтов. Использование встроенного в систему функционала предполагает как совместное, так и раздельное его использование. Для того, что бы начать публиковать статьи надо добавить сайт в систему. После добавления в списке сайтов справа от каждого появится ссылка на модуль статей. Нажав на нее вы попадете на список статей.

h2. Список статей

Каждая статья имеет:
* Заголовок
* Содержимое
* Категорию
* Дату крайней публикации
* Meta-тэги keywords и description
* Поле для управления миниатюрой

Для того, что бы добавить статью надо нажать на ссылку "Добавить статью" в субменю. Вы попадает на форму, которая содержит перечисленные выше поля. Категорию можно выбрать как существующую, так и ввести новую. Категории уникальны для каждого сайта и обязательны к вводу. Если в поле "Статья опубликована до" что-то ввести, то статья будет опубликована на доноре только до указанной даты. После нее публикация будет прекращена.

Статья логически имеет вводную часть и полный текст. В самом тексте они отделяются друг от друга при помощи символов *&lt;cut&gt;*. Вводная часть показывается в листинге, а полная при полном просмотре.

Миниатюра - это одна картинка, которая привязана непосредственно к статье. При загрузке на сервер она будет храниться в папке */data/images* и периодически копироваться на сайт со статьями. Для вставки ее в статью надо написать в нужном месте *{image}* - будет вставлен IMG-тэг с *align='left'*.

h2. Настройки сайта и публикация статей

До или после ввода статей необходимо соответствующим образом настроить систему на публикацию. Во-первых, надо ввести имя директории со статьями, например "articles" или "statii". Разрешены любые английские буквы и цифры. После ввода необходимо нажать на ссылку "[Сохранить]". 

Далее необходимо создать шаблон, в котором будут публиковаться статьи. Шаблон в общем случае содержит до 6 шаблонизируемых полей. После сохранения файл шаблона будет лежать в директории *data*. Для создания проследуйте по ссылке "Генератор шаблона". Опишем вводимые на первом шаге поля:

* Страница целиком - общая страница сайта *в кодировке cp1251* и только в ней. Дело в том, что система существует в именно в этой кодировке и в ней же обрабатывает данные. Непосредственно на сайте данные будут перекодированы в используемую на сайте кодировку. Данные для этого поля получить очень легко - достаточно открыть главную страница вашего сайта, получить исходный код (в Opera - Ctrl+F3, в Firefox - Ctrl+U), скопировать и вставить сюда (для не-cp1251 сайтов надо всего лишь предварительно сохранить в каком-нибудь файле и перекодировать посредством любой программы, которая это умеет). В данном шаблоне возможны следующие подстановки:
** PAGE_TITLE - заголовок страницы
** PAGE_DESCRIPTION - сюда вставится или description статьи или в случае листинга категорий заголовок страницы
** PAGE_KEYWORDS - сюда вставится или keywords статьи или в случае листинга категорий заголовок страницы
** CATEGORIES_AREA - сюда вставляется список категорий, если они есть
** ARTICLES_AREA - сюда вставляется либо список статей, либо статья целиком
* Листинг статей - либо листинг статей в категории, либо листинг статей на главной.
** ARTICLES_ELEMENTS - шаблонизированные статьи объединяются в одну переменную и вставляются сюда
** PAGESWITCH - разделитель страниц
* Статья в листинге - шаблон статьи в листинге.
** ARTICLE_LINK - ссылка на полную статью
** ARTICLE_CONTENT - вводный текст статьи
* Полная статья - шаблон целиком вставляется вместо ARTICLES_AREA в шаблоне страницы
** ARTICLE_TITLE - заголовок статьи
** ARTICLE_CONTENT - полный текст статьи
* Область категорий - общий шаблон вывода категорий. Текст ДО и ПОСЛЕ самих ссылок на листинги категорий
** CATEGORIES_LIST - сюда вставляются объединенные скомпилированные в шаблоны выводы категорий
* Одна категория - шаблон категории в листинге
** CATEGORY_LINK - ссылка на категорию.
* Число статей на страницу - при просмотре любого листинга
* Заголовок стартовой папки - фраза, вставляемая в title

После ввода шаблона вам необходимо сгенерировать код для вставки на сайт. Для этого пройдите по ссылке "Генератор клиентского кода", она ведет на тот же модуль, который генерирует код ссылок, но теперь тут появился дополнительный список выбора типа генерации.

На выходе у вас получится директория с нужным именем, содержащая 4 файла. 3 из них будут со странными именами - это *domain_key* конкретного сайта. Для вас он не несет никакой смысловой нагрузки, но однозначно идентифицирует сайт. Он доступен к просмотру при редактировании сайта. Четвертый файл - это *.htaccess* с инструкциями для *mod_rewrite*. *Важно!!!* - без mod_rewrite данная система работать не будет, ибо тогда не возможно будет скрыть факт ее использования, что чревато.

h2. Логика работы

После загрузки директории на хостинг вы можете проверить ее работоспособность, путем набора ее имени после адреса сайта. Сам скрипт работает почти так же как *llm.php* - соединяется с главным скриптом и получает от него статьи данного сайта, сохраняет их в файл {{{DOMAIN_KEY}}}.txt и в последующем обновляет с заданной периодичностью (по умолчанию 12 часов).

После набора адреса скрипт отображает листинг последних Х добавленных статей (Х равно числу статей на страницу). И если необходимо - навигацию по категориям. Адрес категории имеет вид */ИМЯ_КАТЕГОРИИ/index.html*. Каждая следующая страница категории имеет адрес вида *index-10.html*, где 10 - порядковый номер статьи с которой надо начать показ на этой странице. Статьи, имеющие категории, будут отображены в листинге своих категорий.